<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Analytics Dashboard | TS.Lab üìä</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-N4X8TM74');</script>
  <!-- End Google Tag Manager -->

  <style>
    /* ==========================================
       DASHBOARD PAGE - FULLSCREEN NATIVE
       ========================================== */
    
    body[data-page="dashboard"] {
      overflow: hidden;
    }

    .dashboard-wrapper {
      position: fixed;
      top: var(--nav-height);
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-primary);
    }

    .dashboard-iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }

    /* Loading State */
    .dashboard-loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      z-index: 10;
      transition: opacity 0.5s ease;
    }

    .dashboard-loading.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 3px solid var(--border-color);
      border-top-color: var(--accent-primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      font-size: 0.9rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
      letter-spacing: 0.05em;
    }

    /* Nav active state adjustment */
    .nav-link[data-nav="dashboard"].active {
      color: var(--text-primary);
      background: rgba(99, 102, 241, 0.15);
    }
  </style>
</head>

<body data-page="dashboard">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N4X8TM74"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <!-- Navigation -->
  <nav class="nav">
    <a href="index.html" class="nav-logo">
      <span class="logo-icon">üîß</span>
      <span class="logo-text">TS<span class="logo-dot">.</span>Lab</span>
    </a>
    <div class="nav-links">
      <a href="playlist.html" class="nav-link" data-nav="playlist">
        <span class="nav-icon">üéµ</span>
        Playlist
      </a>
      <a href="utm-builder.html" class="nav-link" data-nav="utm">
        <span class="nav-icon">üîó</span>
        UTM Builder
      </a>
      <a href="debugger.html" class="nav-link" data-nav="debugger">
        <span class="nav-icon">üîç</span>
        Debugger
      </a>
      <a href="dashboard.html" class="nav-link active" data-nav="dashboard">
        <span class="nav-icon">üìä</span>
        Dashboard
      </a>
    </div>
  </nav>

  <!-- Dashboard Fullscreen -->
  <div class="dashboard-wrapper">
    <!-- Loading State -->
    <div class="dashboard-loading" id="loadingState">
      <div class="loading-spinner"></div>
      <span class="loading-text">Caricamento dashboard...</span>
    </div>

    <!-- Dashboard iFrame -->
    <iframe 
      src="https://tslab-dashboard.lovable.app" 
      class="dashboard-iframe"
      title="TS.Lab Analytics Dashboard"
      allow="fullscreen"
      id="dashboardIframe"
    ></iframe>
  </div>

  <script>
    // Hide loading when iframe loads
    const iframe = document.getElementById('dashboardIframe');
    const loading = document.getElementById('loadingState');

    iframe.addEventListener('load', function() {
      loading.classList.add('hidden');
      
      // Track dashboard loaded
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        'event': 'dashboard_loaded',
        'page_name': 'analytics_dashboard'
      });
    });

    // Initial page view
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      'event': 'page_view',
      'page_name': 'dashboard',
      'page_title': 'Analytics Dashboard'
    });
  </script>
</body>
</html>
